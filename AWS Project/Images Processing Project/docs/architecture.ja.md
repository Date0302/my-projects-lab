# Architecture Design

#### 🌐 言語 / Language / 语言

 英語: [architecture.md](architecture.md)                                               日本語: [architecture.ja.md](architecture.ja.md)

## 概要

このプロジェクトは、AWSマネージドサービスを利用したイベント駆動型の画像処理システムを実装しています。

ユーザーが画像をアップロードすると：

1. 画像はAmazon S3に保存されます
2. イベントがAmazon SQSに送信されます
3. AWS Lambdaがメッセージを処理します
4. 画像が処理されます（サムネイル生成）
5. メタデータがDynamoDBに保存されます
6. SNS経由で通知が送信されます

このアーキテクチャは完全にサーバーレスであり、水平方向にスケーラブルです。

## なぜイベント駆動型アーキテクチャなのか？

システムは以下の目的でイベント駆動の原則に基づいて設計されています：

- アップロードと処理の分離
- 耐障害性の向上
- 非同期スケーリングの実現
- ユーザーリクエストのブロック回避

SQSを使用することで、画像処理の失敗がアップロードに影響を与えないようにしています。

## サービス選択の根拠

### Amazon S3

オブジェクトストレージとして使用。理由：

- 高い耐久性（イレブンナイン）
- スケーラブルなストレージ
- ネイティブなイベント連携

### Amazon SQS

選択理由：

- S3とLambdaの分離
- リトライ機能の提供
- 障害時のデータ損失防止

### AWS Lambda

選択理由：

- サーバー管理が不要
- 自動スケーリング
- イベントベースのワークロードにコスト効率が良い

### Amazon DynamoDB

メタデータストレージとして使用。理由：

- 低レイテンシー
- フルマネージド
- インフラ管理なしでスケーラブル

### Amazon SNS

通知に使用。目的：

- ダウンストリームシステムへの通知
- 将来の統合を可能にする

## スケーラビリティ設計

- LambdaはSQSキューのサイズに基づいて自動スケーリング
- S3は事実上無制限のストレージをサポート
- DynamoDBは水平スケーリング
- 手動によるインフラストラクチャのスケーリングは不要

このシステムはアーキテクチャの変更なしにバーストトラフィックを処理できます。

## 障害処理

- SQSはメッセージの永続性を保証
- Lambdaのリトライメカニズムが一時的なエラーを処理
- CloudWatchログでデバッグが可能

この設計により、信頼性と運用の可視性が向上します。

## 本番環境での考慮事項

本番環境では：

- 依存関係はLambda Layersを使用してパッケージ化する必要があります
- CI/CDでデプロイの自動化を行うべきです
- CloudWatchでアラームを設定する必要があります
- 高度な障害処理のためにデッドレターキュー（DLQ）を追加できます
